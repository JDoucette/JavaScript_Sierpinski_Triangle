<!--
from:		Michael Pohoreski <michael.pohoreski@gmail.com>
to:			Jason Doucette <jason@xona.com>
cc:			Dave Voyles <dnvoyles@gmail.com>,
			Matthew Doucette <matt@xona.com>
date:	Jan 9, 2015, 11:26 PM
subject:	Re: What's your favorite “programmer” cartoon?
-->

<html>
    <head>
        <script>
            var hCanvas  = undefined;
            var hContext = undefined;
            var nCanvasW = 0;
            var nCanvasH = 0;
            var tImage   = undefined;
            var aTexels  = undefined;

            var nTimerId = 0;

            var nPoints  = 0;
            var px = new Array(4);
            var py = new Array(4);


            function plot( x,y,r,g,b,a )
            {
                var i   = (y*nCanvasW + x)*4; // 32-bit RGBA
                if( r === undefined ) r = (Math.random() * 255) | 0;
                if( g === undefined ) g = (Math.random() * 255) | 0;
                if( b === undefined ) b = (Math.random() * 255) | 0;
                if( a === undefined ) a = 255;

                aTexels[i+0] = r;
                aTexels[i+1] = g;
                aTexels[i+2] = b;
                aTexels[i+3] = a;
            }

            function randXY()
            {
                return {
                    x: (Math.random() * nCanvasW) | 0,
                    y: (Math.random() * nCanvasH) | 0
                };
            }

            function init()
            {
                var x, y, p;
                for( var i = 0; i < px.length; i++ )
                {
                    p = randXY();
                    px[i] = p.x;
                    py[i] = p.y;
                    plot( p.x, p.y );
                }
            }

            function update()
            {
                var i = (3  *Math.random()+1) | 0;
                px[0] = (0.5*(px[0] + px[i])) | 0;
                py[0] = (0.5*(py[0] + py[i])) | 0;
                plot( px[0], py[0] );
                    hContext.putImageData( tImage, 0, 0 );
            }

            function main()
            {
                hCanvas  = document.getElementById("MyCanvas");
                hContext = hCanvas.getContext("2d");
                nCanvasW = hCanvas.width;
                nCanvasH = hCanvas.height;
                tImage   = hContext.getImageData( 0,0,nCanvasW,nCanvasH);
                aTexels  = tImage.data; 

                init();
                nTimerId = setInterval( function() { update(); }, 10 );
            }
        </script>
    <body onload="main()">
        <canvas id="MyCanvas" width="256" height="256"></canvas>
    </body>
</html>